<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OENO K√≥d Keres≈ë</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Outfit:wght@300;500;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Outfit', sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
            color: #1e293b;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container { max-width: 500px; width: 100%; text-align: center; }
        
        h1 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #dc2626, #f97316);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle { font-size: 0.9rem; color: #64748b; margin-bottom: 30px; }
        
        .input-section {
            background: #fff;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }
        
        .input-row {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .code-input {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            width: 140px;
            padding: 15px;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            text-align: center;
            color: #1e293b;
            background: #f8fafc;
        }
        
        .code-input:focus {
            outline: none;
            border-color: #dc2626;
        }
        
        .search-btn, .mic-btn {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .search-btn {
            background: linear-gradient(145deg, #dc2626, #f97316);
            color: #fff;
        }
        
        .mic-btn {
            border: 2px solid #e2e8f0;
            background: #fff;
            color: #64748b;
        }
        
        .mic-btn.listening {
            animation: pulse 1.5s infinite;
            background: linear-gradient(145deg, #0ea5e9, #06b6d4);
            border-color: transparent;
            color: #fff;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }
        
        .status {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            margin: 15px 0;
            min-height: 25px;
            color: #64748b;
        }
        
        .status.listening { color: #0ea5e9; }
        .status.success { color: #16a34a; }
        .status.error { color: #dc2626; }
        
        .result-box {
            background: #fff;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            min-height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .input-code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.2rem;
            color: #94a3b8;
            margin-bottom: 10px;
        }
        
        .output-code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(90deg, #16a34a, #059669);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .description {
            font-size: 0.9rem;
            color: #64748b;
            margin-top: 15px;
        }
        
        .hint {
            font-size: 0.8rem;
            color: #94a3b8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>OENO K√≥d Keres≈ë</h1>
        <p class="subtitle">R√∂ntgen leletez√©si k√≥dok</p>
        
        <div class="input-section">
            <div class="input-row">
                <input type="text" class="code-input" id="codeInput" maxlength="3" placeholder="000" autocomplete="off" inputmode="numeric">
                <button class="search-btn" onclick="searchCode()">‚Üí</button>
                <button class="mic-btn" id="micBtn" onclick="toggleListening()">üé§</button>
            </div>
            <p class="hint">√çrd be a 3 sz√°mjegyet + Enter, vagy haszn√°ld a mikrofont</p>
        </div>
        
        <div class="status" id="status">K√©szen √°ll</div>
        
        <div class="result-box">
            <div class="input-code" id="inputCode">31___</div>
            <div class="output-code" id="outputCode">‚Äî</div>
            <div class="description" id="description"></div>
        </div>
    </div>

    <script>
        // OENO k√≥d adatb√°zis
        const codeDatabase = {
            "010": { output: "085", desc: "Mandibula felv√©tel + leletez√©s" },
            "020": { output: "086", desc: "√Ållkapocs√≠z√ºleti felv√©tel" },
            "021": { output: "087", desc: "√Ållcs√∫cs felv√©tel" },
            "030": { output: "088", desc: "Radiographia dentalis extraoralis" },
            "040": { output: "089", desc: "Radiographia dentalis panoramica" },
            "050": { output: "090", desc: "Radiographia dentalis intraoralis" },
            "060": { output: "091", desc: "Teleradiographia dentalis" },
            "100": { output: "092", desc: "Koponyafelv√©tel, AP/PA" },
            "101": { output: "093", desc: "Koponyafelv√©tel, oldalir√°ny√∫" },
            "102": { output: "094", desc: "Koponyafelv√©tel, k√©tir√°ny√∫" },
            "103": { output: "095", desc: "Koponyafelv√©tel, Towne szerint" },
            "104": { output: "096", desc: "Koponyafelv√©tel, tangenci√°lis" },
            "110": { output: "097", desc: "Basis felv√©tel" },
            "130": { output: "098", desc: "Sella felv√©tel" },
            "140": { output: "099", desc: "Stenvers felv√©tel" },
            "141": { output: "100", desc: "Sch√ºller felv√©tel" },
            "142": { output: "101", desc: "Mayer felv√©tel" },
            "200": { output: "102", desc: "Orrmell√©k√ºreg felv√©tel" },
            "201": { output: "103", desc: "Rhese felv√©tel" },
            "210": { output: "104", desc: "Arcus zygomaticus felv√©tel" },
            "211": { output: "105", desc: "Orrcsont felv√©tel oldalir√°nyb√≥l" },
            "212": { output: "106", desc: "Arckoponya felv√©tel" },
            "230": { output: "107", desc: "Orbita felv√©tel" },
            "231": { output: "108", desc: "Orbita felv√©tel, sweet technik√°val" },
            "300": { output: "109", desc: "Trachea l√©gs√°v felv√©tel" },
            "310": { output: "110", desc: "Mellkasfelv√©tel, AP/PA" },
            "311": { output: "111", desc: "Mellkasfelv√©tel, oldalir√°ny√∫" },
            "312": { output: "112", desc: "Mellkasfelv√©tel, k√©tir√°ny√∫" },
            "380": { output: "113", desc: "Mellkasfelv√©tel, c√©lzott" },
            "381": { output: "114", desc: "Borda felv√©tel" },
            "382": { output: "115", desc: "Sternum felv√©tel" },
            "383": { output: "116", desc: "Sternum oldalir√°ny√∫ felv√©tel" },
            "384": { output: "117", desc: "Sternum kivet√≠tett felv√©tel" },
            "410": { output: "118", desc: "Epet√°ji nat√≠v felv√©tel" },
            "420": { output: "119", desc: "Vese √©s h√≥lyag nat√≠v felv√©tel" },
            "421": { output: "120", desc: "H√≥lyagt√°j nat√≠v felv√©tel" },
            "440": { output: "121", desc: "Has nat√≠v felv√©tel" },
            "441": { output: "122", desc: "Baby-gram" },
            "442": { output: "123", desc: "Wangensteen-Rice felv√©tel" },
            "460": { output: "124", desc: "Has c√©lzott felv√©tel" },
            "500": { output: "125", desc: "Dens felv√©tel" },
            "510": { output: "126", desc: "Nyaki gerinc, AP felv√©tel" },
            "511": { output: "127", desc: "Nyaki gerinc, oldalir√°ny√∫ felv√©tel" },
            "512": { output: "128", desc: "Nyaki gerinc, k√©tir√°ny√∫" },
            "513": { output: "129", desc: "Gerinc vizsg√°lat, funkcion√°lis" },
            "515": { output: "130", desc: "Nyaki-h√°ti gerinc √°tmenet, AP" },
            "516": { output: "131", desc: "Nyaki-h√°ti gerinc √°tmenet, oldalir√°ny√∫" },
            "517": { output: "132", desc: "Nyaki-h√°ti gerinc √°tmenet, k√©tir√°ny√∫" },
            "530": { output: "133", desc: "H√°ti gerinc, AP felv√©tel" },
            "531": { output: "134", desc: "H√°ti gerinc, oldalir√°ny√∫ felv√©tel" },
            "532": { output: "135", desc: "H√°ti gerinc, k√©tir√°ny√∫ felv√©tel" },
            "535": { output: "136", desc: "H√°ti-√°gy√©ki gerinc √°tmenet, AP" },
            "536": { output: "137", desc: "H√°ti-√°gy√©ki gerinc √°tmenet, oldalir√°ny√∫" },
            "537": { output: "138", desc: "H√°ti-√°gy√©ki gerinc √°tmenet, k√©tir√°ny√∫" },
            "540": { output: "139", desc: "Lumbalis gerinc, AP felv√©tel" },
            "541": { output: "140", desc: "Lumbalis gerinc, oldalir√°ny√∫" },
            "542": { output: "141", desc: "Lumbalis gerinc, k√©tir√°ny√∫" },
            "544": { output: "142", desc: "Lumbosacralis gerinc, AP" },
            "545": { output: "143", desc: "Lumbosacralis gerinc, oldalir√°ny√∫" },
            "546": { output: "144", desc: "Lumbosacralis gerinc, k√©tir√°ny√∫" },
            "548": { output: "145", desc: "Bending felv√©tel" },
            "550": { output: "146", desc: "Sacrum coccygeum, AP felv√©tel" },
            "551": { output: "147", desc: "Sacrum coccygeum, oldalir√°ny√∫" },
            "552": { output: "148", desc: "Sacrum, k√©tir√°ny√∫ felv√©tel" },
            "560": { output: "149", desc: "Foramen vertebrarum felv√©tel" },
            "561": { output: "150", desc: "Dittmar felv√©tel" },
            "600": { output: "151", desc: "Clavicula felv√©tel" },
            "601": { output: "152", desc: "Sterno-clavicularis √≠z√ºleti felv√©tel" },
            "602": { output: "153", desc: "Acromio-clavicularis √≠z√ºleti felv√©tel" },
            "603": { output: "154", desc: "Scapula felv√©tel" },
            "604": { output: "155", desc: "V√°ll, AP felv√©tel" },
            "605": { output: "156", desc: "V√°llak √∂sszehasonl√≠t√≥ AP felv√©telei" },
            "606": { output: "157", desc: "V√°ll, axi√°lis felv√©tel" },
            "607": { output: "158", desc: "V√°ll, transthoracalis felv√©tel" },
            "608": { output: "159", desc: "V√°ll, terhel√©ses felv√©tel" },
            "650": { output: "160", desc: "Medence, AP felv√©tel" },
            "651": { output: "161", desc: "Cs√≠p≈ë√≠z√ºlet, AP felv√©tel" },
            "652": { output: "162", desc: "Cs√≠p≈ë√≠z√ºlet, oldalir√°ny√∫ felv√©tel" },
            "653": { output: "163", desc: "Cs√≠p≈ë√≠z√ºlet, Lauenstein felv√©tel" },
            "654": { output: "164", desc: "Obturator felv√©tel" },
            "655": { output: "165", desc: "Ala felv√©tel" },
            "656": { output: "166", desc: "Medence bemenet felv√©tel" },
            "657": { output: "167", desc: "Medence kimenet felv√©tel" },
            "660": { output: "168", desc: "Gerinc, teljes AP felv√©tel" },
            "661": { output: "169", desc: "Oldalir√°ny√∫ teljes gerincfelv√©tel" },
            "662": { output: "170", desc: "Risser-cs√≠k felv√©tel" },
            "710": { output: "171", desc: "Humerus, k√©tir√°ny√∫ felv√©tel" },
            "720": { output: "172", desc: "K√∂ny√∂k, k√©tir√°ny√∫ felv√©tel" },
            "725": { output: "173", desc: "√ñsszehasonl√≠t√≥ k√∂ny√∂k felv√©tel" },
            "730": { output: "174", desc: "Olecranon ulnae, axialis felv√©tel" },
            "731": { output: "175", desc: "Alkar, k√©tir√°ny√∫ felv√©tel" },
            "740": { output: "176", desc: "Csukl√≥, k√©tir√°ny√∫ felv√©tel" },
            "741": { output: "177", desc: "Csukl√≥, tartott felv√©tel" },
            "742": { output: "178", desc: "Csukl√≥-k√©z felv√©tel" },
            "750": { output: "179", desc: "Os naviculare, n√©gyir√°ny√∫ felv√©tel" },
            "751": { output: "180", desc: "Os naviculare felv√©tel" },
            "755": { output: "181", desc: "√ñsszehasonl√≠t√≥ k√©z felv√©tel AP ir√°nyban" },
            "760": { output: "182", desc: "K√©z, k√©tir√°ny√∫ felv√©tel" },
            "761": { output: "183", desc: "K√©z I. ujj, k√©tir√°ny√∫ felv√©tel" },
            "762": { output: "184", desc: "K√©zujjak k√©tir√°ny√∫ felv√©tele" },
            "763": { output: "185", desc: "Ujj, tartott felv√©tel" },
            "800": { output: "186", desc: "Teljes als√≥v√©gtagi r√∂ntgenfelv√©tel" },
            "810": { output: "187", desc: "Femur, k√©tir√°ny√∫ felv√©tel" },
            "819": { output: "188", desc: "√ñsszehasonl√≠t√≥ t√©rdfelv√©tel" },
            "820": { output: "189", desc: "T√©rd, k√©tir√°ny√∫ felv√©tel" },
            "821": { output: "190", desc: "T√©rd, tartott felv√©tel" },
            "822": { output: "191", desc: "Patella, axi√°lis felv√©tel" },
            "823": { output: "192", desc: "Alag√∫t betekint≈ë felv√©tel" },
            "830": { output: "193", desc: "L√°bsz√°r, k√©tir√°ny√∫ felv√©tel" },
            "840": { output: "194", desc: "Boka, k√©tir√°ny√∫ felv√©tel" },
            "841": { output: "195", desc: "Boka, tartott felv√©tel" },
            "842": { output: "196", desc: "Boka, h√°romir√°ny√∫ felv√©tel" },
            "850": { output: "197", desc: "Sarokcsont, oldalir√°ny√∫ felv√©tel" },
            "851": { output: "198", desc: "Sarokcsont, axialis felv√©tel" },
            "852": { output: "199", desc: "Talocalcanealis betekint≈ë felv√©tel" },
            "860": { output: "200", desc: "L√°b, k√©tir√°ny√∫ felv√©tel" },
            "861": { output: "201", desc: "L√°b I. ujj, k√©tir√°ny√∫ felv√©tel" },
            "862": { output: "202", desc: "L√°b egy√©b ujjair√≥l k√©tir√°ny√∫ felv√©tel" },
            "863": { output: "203", desc: "L√°b √∂sszehasonl√≠t√≥ felv√©tel" }
        };

        // Magyar sz√°m szavak
        const numberWords = {
            "nulla": "0", "egy": "1", "kett≈ë": "2", "h√°rom": "3", "n√©gy": "4",
            "√∂t": "5", "hat": "6", "h√©t": "7", "nyolc": "8", "kilenc": "9"
        };
        
        const digitWordsHu = ['nulla', 'egy', 'kett≈ë', 'h√°rom', 'n√©gy', '√∂t', 'hat', 'h√©t', 'nyolc', 'kilenc'];

        let recognition = null;
        let isListening = false;

        const codeInput = document.getElementById('codeInput');
        const status = document.getElementById('status');
        const micBtn = document.getElementById('micBtn');

        // F√≥kusz
        window.onload = () => codeInput.focus();

        function updateStatus(text, type = '') {
            status.textContent = text;
            status.className = 'status' + (type ? ' ' + type : '');
        }

        // Sz√∂vegb≈ël sz√°mok
        function parseSpokenNumbers(text) {
            text = text.toLowerCase().trim();
            let result = '';
            
            const directDigits = text.replace(/[^0-9]/g, '');
            if (directDigits.length >= 3) return directDigits.slice(-3);
            
            const words = text.split(/[\s,.-]+/);
            for (const word of words) {
                if (/^\d$/.test(word)) result += word;
                else if (numberWords[word]) result += numberWords[word];
            }
            
            return result.length >= 3 ? result.slice(-3) : result.padStart(3, '0');
        }

        // Felolvas√°s magyarul, ut√°na √∫jra figyel
        function speakResult(code) {
            const text = code.split('').map(d => digitWordsHu[parseInt(d)]).join(', ');
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'hu-HU';
            utterance.rate = 0.85;
            
            utterance.onend = () => {
                codeInput.value = '';
                // √öjraind√≠t√°s
                setTimeout(() => toggleListening(), 500);
            };
            
            speechSynthesis.speak(utterance);
        }

        // Keres√©s
        function lookupCode(inputCode) {
            const data = codeDatabase[inputCode];
            document.getElementById('inputCode').textContent = '31' + inputCode;
            
            if (data) {
                document.getElementById('outputCode').textContent = '99' + data.output;
                document.getElementById('description').textContent = data.desc;
                updateStatus('Tal√°lat!', 'success');
                speakResult(data.output);
            } else {
                document.getElementById('outputCode').textContent = '‚Äî';
                document.getElementById('description').textContent = '';
                updateStatus('Nem tal√°lhat√≥', 'error');
                // √öjraind√≠t√°s nem tal√°lat eset√©n is
                setTimeout(() => toggleListening(), 1000);
            }
        }

        // Billenty≈±zetes keres√©s
        function searchCode() {
            const code = codeInput.value.trim().padStart(3, '0');
            if (code.length >= 1) lookupCode(code);
        }

        codeInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                searchCode();
            }
        });

        codeInput.addEventListener('input', (e) => {
            e.target.value = e.target.value.replace(/[^0-9]/g, '');
        });

        // Hangfelismer√©s - egyszer≈±, nincs automatikus √∫jraind√≠t√°s
        function toggleListening() {
            if (isListening) {
                // Le√°ll√≠t√°s
                if (recognition) recognition.stop();
                isListening = false;
                micBtn.classList.remove('listening');
                updateStatus('Meg√°ll√≠tva');
                return;
            }

            // Ind√≠t√°s
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('A b√∂ng√©sz≈ë nem t√°mogatja a hangfelismer√©st.');
                return;
            }

            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'hu-HU';
            recognition.continuous = false;
            recognition.interimResults = false;

            recognition.onstart = () => {
                isListening = true;
                micBtn.classList.add('listening');
                updateStatus('Figyelek...', 'listening');
            };

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                console.log('Hallottam:', transcript);
                const code = parseSpokenNumbers(transcript);
                
                if (code && code.length === 3) {
                    codeInput.value = code;
                    lookupCode(code);
                } else {
                    updateStatus('Nem √©rtettem: ' + transcript, 'error');
                }
            };

            recognition.onerror = (event) => {
                console.log('Hiba:', event.error);
                updateStatus('Hiba: ' + event.error, 'error');
                isListening = false;
                micBtn.classList.remove('listening');
            };

            recognition.onend = () => {
                isListening = false;
                micBtn.classList.remove('listening');
                if (status.textContent === 'Figyelek...') {
                    updateStatus('K√©szen √°ll');
                }
            };

            recognition.start();
        }
    </script>
</body>
</html>
